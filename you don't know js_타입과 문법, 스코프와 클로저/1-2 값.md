# YOU DON'T KNOW JS

## Part 1 타입과 문법

### Chapter 2 값

#### 1. 배열

- 자바스크립트의 배열은 문자열, 숫자, 객체, 다른 배열 등 어떤 타입의 값이라도 담을 수 있는 그릇이다.

```javascript
var a = [1, '2', [3]]

a.length; // 3
a[0] === 1; // true
a[2][0] === 3 // true
```

- 구멍난(sparse) 배열을 다룰 때는 조심해야 한다.

```javascript
var a = [];

a[0] = 1;
a[2] = [3];

a[1]; // undefined
a.length; // 3
```

- a[1] 슬롯 값은 명시적으로 a[1] = undefined 세팅한 것과 같지 않다.

```javascript
var a = [];

a[0] = 1;
a["foobar"] = 2;

console.log(a.length); // 1
console.log(a.foobar); // 2
console.log(a["foobar"]); // 2
```

- 배열 인덱스는 숫자인데, 배열 자체도 하나의 객체여서 키/프로퍼티를 추가할 수 있다.
  - 하지만 배열의 length는 증가하지 않는다.

```javascript
var a = [];
a["13"] = 42;
console.log(a.length); // 14
```

- 키로 넣은 문자열 값이 표준 10진수 숫자로 타입이 바뀌면, 문자열 키가 아닌 숫자 키를 사용한 것 같은 결과가 초래된다.
  - 일반적으로 키/프로퍼티를 사용하는 것은 추천하지 않는다.

#### 2. 문자열

- 자바스크립트 문자열은 문자 배열과 같지 않다.
  - 문자열은 유사 배열이다.
  - length, indexOf(), cancat()를 갖는다.

```javascript
var a = 'foo';
var b = ['f', 'o', 'o'];

console.log(a.length); // 3
console.log(b.length); // 3

console.log(a.indexOf('o')); // 1
console.log(b.indexOf('o')); // 1

var c = a.concat('bar'); // 'foobar'
var d = b.concat('bar'); // ['f', 'o', 'o', 'b', 'a', 'r']

console.log(a === c); // false
console.log(b === d); // false

console.log(a); // foo
console.log(b); // ['f', 'o', 'o']

a[1] = 'O';
b[1] = 'O';

console.log(a); // foo
console.log(b); // ['f', 'O', 'o']
```

- 문자열은 불변 값(Immutable)이지만 배열은 가변 값(Mutable)이다.
- 문자열은 메서드는 그 내용을 바로 변경하지 않고 항상 새로운 문자열을 생성한 후 반환한다.
  - 대부분의 배열 메서드는 그 자리에서 곧바로 원소를 수정한다.
- 문자열 작업을 빈번하게 수행하는 경우라면 문자 단위로 저장하는 배열로 취급하는 것이 더 나을 수도 있다.
  - 문자열로 나타낼 때는 배열에 join(' ') 메서드를 호출하면 된다.

#### 3. 숫자

- 자바스크립트의 숫자 타입은 Number가 유일하며 정수(Integer), 부동 소수점 숫자(Fractional Decimal Number)를 모두 아우른다.

##### 숫자 구문

- 숫자 리터럴은 10진수 리터럴로 표시한다.
  - 대부분의 숫자는 10진수가 디폴트고 소수점 이하는 0을 뗀다.
- 매우 크거나 작은 숫자는 지수형(Exponent Form)으로 표시하며, toExponential() 메서드의 결과 값과 같다.
- 숫자 값은 Number 객체 래퍼(Wrapper)로 박싱(Boxing)할 수 있기 때문에 Number.prototype 메서드로 접근할 수 있다.

##### 작은 소수 값

```javascript
console.log(0.1 + 0.2 === 0.3); // false
```

- 이진 부동 소수점으로 나타낸 0.1과 0.2는 원래의 숫자와 일치하지 않는다.
  - 더한 값은 실제로 0.30000000000000004에 가깝다.
- 일반적으로 미세한 반올림 오차를 허용 공차(Tolerance)로 처리하는 방법이 있다.
  - 미세한 오차를 머신 입실론(Machine Epsilon)이라고 하며, 자바스크립트 숫자의 머신 입실론은 2^-52이다.
- ES6부터는 Number.EPSILON으로 미리 정의되어 있다.

```javascript
function numbersCloseEnoughToEqual(n1, n2) {
    return Math.abs(n1 - n2) < Number.EPSILON;
}

var a = 0.1 + 0.2;
var b = 0.3;

console.log(numbersCloseEnoughToEqual(a, b)); // true
console.log(numbersCloseEnoughToEqual(0.00000001, 0.00000002)); // false
```

##### 안전한 정수 범위

- 정수는 Number.MAX_VALUE보다 훨씬 작은 수///준에서 안전 값의 범위가 정해져 있다.
- 안전하게 표현할 수 있는 정수는 최대 (2^53 - 1)이다.
  - ES6에서 최댓값은 Number.MAX_SAFE_INTEGER로 정의하고, 최솟값은 Number.MIN_SAFE_INTEGER로 정의한다.
- 자바스크립트 프로그램에서 아주 큰 숫자를 맞닥뜨리는 경우는 데이터베이스 등에서 64비트 ID를 처리할 때가 대부분이다.
- 64비트 숫자는 숫자 타입으로 정확하게 표시할 수 없으므로 string 타입으로 저장해야 한다.

##### 정수인지 확인

- ES6부터는 Number.isInteger()로 어떤 값의 정수 여부를 확인한다.

```javascript
console.log(Number.isInteger(42)); // true
console.log(Number.isInteger(42.000)); // true
console.log(Number.isInteger(42.3)); // false
```

- 안전한 정수 여부는 ES6부터 Number.isSafeInteger()로 체크한다.

```javascript
console.log(Number.isSafeInteger(Number.MAX_SAFE_INTEGER)); // true
console.log(Number.isSafeInteger(Math.pow(2, 53))); // false
console.log(Number.isSafeInteger(Math.pow(2, 53) - 1)); // true
```

##### 32비트(부호 있는) 정수

- 정수의 안전 범위는 2^53에 이르지만 32비트 숫자에만 가능한 연산이 있으므로 실제 범위는 훨씬 줄어든다.
  - 따라서 정수의 안전 범위는 (-2^31 ~ 2^31 - 1)까지다.
- a | 0과 같이 쓰면 숫자 값을 32비트 부호 있는 정수로 강제 변환을 한다.
- 0과 OR 연산은 본질적으로 NOOP 비트 연산과 같다.
